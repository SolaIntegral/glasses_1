# 🎉 ローカルモックモード完全ガイド

## ✅ システムが完全にローカルで動作します！

Firebase Emulatorは不要で、全てのデータはブラウザのローカルストレージに保存されます。

---

## 🚀 起動方法

### 1. Next.jsアプリケーションの起動

```bash
npm run dev
```

### 2. ブラウザでアクセス

**URL**: http://localhost:3000

---

## 📊 ローカルモックモードの特徴

### ✅ 完全ローカル
- **Firebase Emulator不要**
- **インターネット接続不要**
- **外部サービス不要**

### ✅ データ保存
- 全てのデータは**ブラウザのローカルストレージ**に保存
- ブラウザを閉じてもデータは保持される
- 複数のタブで同じデータを共有

### ✅ リアルタイム更新
- データの変更は即座に反映
- ページリロードで最新データを取得

---

## 🧪 テスト手順

### Step 1: 講師アカウント作成

1. http://localhost:3001 を開く（ポート3001で動作中）
2. 「新規登録」をクリック
3. 以下の情報を入力：
   ```
   名前: 山田太郎
   ユーザーID: instructor001
   パスワード: password123
   確認パスワード: password123
   登録種別: 講師として登録
   ```
4. 「登録」をクリック

**✨ メールアドレス不要！**
- ユーザーIDとパスワードだけで登録可能
- 個人情報（メールアドレス）を収集しません
- 英数字とアンダースコア(_)が使用可能

### Step 2: 講師として空き時間を登録

1. ログイン後、ダッシュボードが表示される
2. 「空き時間を追加」または「空き時間管理」をクリック
3. **一括登録**を試してみる：
   - 「一括登録する」ボタンをクリック
   - 確認ダイアログで「OK」
   - 約18件の空き時間が登録される

### Step 3: 生徒アカウント作成

1. **別のブラウザまたはシークレットモード**で http://localhost:3001 を開く
2. 「新規登録」をクリック
3. 以下の情報を入力：
   ```
   名前: 田中花子
   ユーザーID: student001
   パスワード: password123
   確認パスワード: password123
   登録種別: 生徒として登録
   ```
4. 「登録」をクリック

### Step 4: 予約してみる

1. 「講師一覧」が表示される
2. 山田太郎先生のカードをクリック
3. カレンダーから空き時間を選択
4. 相談内容を入力して「予約する」
5. 予約完了！

### Step 5: キャンセルしてみる

1. 「マイ予約」をクリック
2. 予約一覧が表示される
3. 「キャンセル」ボタンをクリック
4. 確認して実行

---

## 🔍 データの確認方法

### ブラウザの開発者ツールで確認

1. **F12**を押して開発者ツールを開く
2. **Application**タブをクリック
3. **Local Storage** → **http://localhost:3000**を選択
4. 以下のキーでデータを確認：

```
mockUser                    # 現在のログインユーザー
mock_users_*               # ユーザー情報
mock_instructors_*         # 講師情報
mock_availableSlots_*      # 空き時間
mock_bookings_*            # 予約情報
```

### データの例

```json
// mock_users_instructor001
{
  "uid": "user_1697898000000",
  "userId": "instructor001",
  "displayName": "山田太郎",
  "role": "instructor",
  "createdAt": "2025-10-21T13:30:00.000Z",
  "updatedAt": "2025-10-21T13:30:00.000Z"
}

// mock_availableSlots_mock_slot_***
{
  "instructorId": "mock-uid",
  "startTime": "2025-10-22T10:00:00.000Z",
  "endTime": "2025-10-22T11:00:00.000Z",
  "isBooked": false,
  "createdAt": "2025-10-21T13:30:00.000Z"
}
```

---

## 🎯 実装された機能

### ✅ 認証機能
- [x] 新規登録（生徒・講師）
- [x] ログイン・ログアウト
- [x] ロール別リダイレクト
- [x] 認証状態の管理
- [x] **ユーザーIDベース認証**（メールアドレス不要）
- [x] **プライバシー保護**（個人情報収集なし）

### ✅ 講師機能
- [x] ダッシュボード（統計情報）
- [x] 空き時間管理（個別・一括登録）
- [x] 予約一覧（フィルター機能）
- [x] プロフィール編集

### ✅ 生徒機能
- [x] 講師一覧（カード表示）
- [x] 講師詳細・予約
- [x] マイ予約（今後・過去）
- [x] 予約キャンセル

### ✅ ビジネスロジック
- [x] 24時間前予約制限
- [x] 24時間前キャンセル制限
- [x] 二重予約防止
- [x] 空き時間の予約・復元

---

## 🔧 トラブルシューティング

### 問題1: データが保存されない

**解決方法**:
1. ブラウザの開発者ツールを開く
2. Consoleタブでエラーを確認
3. Local Storageにデータが保存されているか確認

### 問題2: 予約できない

**解決方法**:
1. 24時間以上先の時間を選択しているか確認
2. 空き時間が登録されているか確認
3. ブラウザのコンソールでエラーメッセージを確認

### 問題3: 講師一覧が表示されない

**解決方法**:
1. 講師アカウントでログインしているか確認
2. プロフィール編集で`isActive: true`になっているか確認
3. Local Storageに`mock_instructors_*`のデータがあるか確認

---

## 📁 ファイル構成

```
glasses_1/
├── lib/firebase/
│   ├── config.ts          # ローカルモック設定
│   ├── auth.ts           # 認証（ローカルモック版）
│   ├── instructors.ts    # 講師管理（ローカルモック版）
│   ├── availability.ts   # 空き時間管理（ローカルモック版）
│   └── bookings.ts       # 予約管理（ローカルモック版）
├── types/index.ts        # 型定義（Firebase依存なし）
└── app/                  # Next.js App Router
```

---

## 🎊 完成！

**完全にローカルで動作する予約システムが完成しました！**

### 特徴
- ✅ **Firebase Emulator不要**
- ✅ **インターネット接続不要**
- ✅ **外部サービス不要**
- ✅ **完全にローカルで動作**
- ✅ **データはローカルストレージに保存**

### 次のステップ
1. **動作確認**: 上記のテスト手順に従って動作確認
2. **機能追加**: 必要に応じて機能を拡張
3. **UI改善**: デザインの調整
4. **本番デプロイ**: 必要に応じてFirebaseに移行

何か問題があれば、ブラウザの開発者ツールでエラーを確認してください！

---

---

## 🔒 プライバシー保護の特徴

### ✅ メールアドレス不要
- ユーザーIDとパスワードのみで認証
- 個人情報を一切収集しません
- 高校生・社会人も安心して利用可能

### ✅ ユーザーIDの規則
- 英数字とアンダースコア(_)のみ使用可能
- 3文字以上20文字以下
- 例: `instructor001`, `student_2024`, `user123`

### ✅ データ保存
- 全てのデータはブラウザのローカルストレージに保存
- 外部サーバーに個人情報を送信しません
- 完全にローカルで動作

### ✅ 運営メリット
- メールアドレス管理が不要
- 個人情報保護法への対応が簡単
- ユーザーが安心して利用できる
- データ漏洩リスクが最小限

---

**開発完了日**: 2025年10月21日  
**動作環境**: 完全ローカル（Firebase Emulator不要）  
**プライバシー**: メールアドレス不要・個人情報収集なし
